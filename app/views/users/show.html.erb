<% provide(:title, @user.name) %>
<div class="user-show-wrapper py-4">
  <div class="row py-4">
    <div class="row col-md-10 offset-md-1 col-lg-8 offset-lg-2 user-info mb-4">
      <div class="col-md-8 col-lg-9">
        <div class="row">
          <div class="col-md-3 d-flex justify-content-center align-items-center">
            <%= image_tag @user.display_image, alt: "User image", class: "rounded-circle", width: 100, height: 100 %>
          </div>
          <div class="col-md-9 d-flex flex-column justify-content-center">
            <h1 class="fs-2 m-0 text-start"><%= @user.name %></h1>
            <div class="user-age-gender mt-2">
              <span>年齢: <%= @user.age.present? ? @user.age : '未登録' %>　|　</span>
              <span>性別: <%= @user.gender.present? ? @user.gender : '未登録' %></span>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-lg-3 user-btn d-flex flex-column justify-content-center align-items-stretch">
        <% if @user == current_user %>
          <%= link_to 'プロフィールを編集', edit_user_registration_path, class: 'btn btn-outline-primary btn-sm my-1' %>
          <%= link_to "プロフィール詳細", profile_user_path, class: 'btn btn-outline-primary btn-sm my-1' %>
          <%= link_to "アカウント削除", users_path, method: :delete, data: { turbo_method: :delete }, class: 'btn btn-danger btn-sm my-1' %>
        <% end %>
      </div>
    </div>
    <div class="col-md-10 offset-md-1 col-lg-8 offset-lg-2 user-nav">
      <ul class="nav nav-tabs mb-3">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">店舗に関する投稿</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">譲りたい</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">貰いたい</a>
        </li>
      </ul>
      <% if @shopposts.any? %>
        <ol class="list-group">
          <% @shopposts.each do |shoppost| %>
            <li class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
              <%= image_tag @user.display_image, alt: "User image", class: "rounded-circle flex-shrink-0", width: 50, height:50  %>
              <div class="d-flex w-100 justify-content-between">
                <div class="row">
                  <h5 class="mb-2"><%= shoppost.user.name %></h5>
                  <h6 class="mb-2">店舗名：
                    <%= link_to shoppost.shop.name, shoppost.shop %>
                  </h6>
                  <p class="mb-2 opacity-75"><%= shoppost.content %></p>
                  <% if shoppost.images.attached? %>
                    <% shoppost.images.each do |image| %>
                      <div class="col-md-10 offset-md-1 mb-2">
                        <%= image_tag image, alt: "Shoppost image", class: "shoppost-img rounded" %>
                      </div>
                    <% end %>
                  <% end %>
                  <div class="d-flex justify-content-between opacity-50">
                    <small>
                      投稿日時：<%= time_ago_in_words(shoppost.created_at) %>前
                    </small>
                    <% if current_user&.== shoppost.user %>
                      <small>
                        <%= link_to "削除", shoppost, data: { turbo_method: :delete, turbo_confirm: "削除して問題ないですか？" } %>
                      </small>
                    <% end %>
                  </div>
                </div>
              </div>
            </li>
          <% end %>
        </ol>
      <% end %>
    </div>
  </div>
</div>
